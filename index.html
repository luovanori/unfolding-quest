<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Landscape Within</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/tone@14.7.77/build/Tone.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400&display=swap" rel="stylesheet">
    <style>
        /* UPDATED: Using a cleaner font to match the illustration style */
        body {
            font-family: 'Inter', sans-serif;
            overflow: hidden;
            /* UPDATED: Light background color */
            background-color: #f8f9fa;
        }

        /* The main container, ensuring it's centered and covers the screen */
        #gate-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            /* UPDATED: Light background color */
            background-color: #f8f9fa;
            transition: background-color 2s ease-in-out;
        }
        
        /* REMOVED: The dark, blurry texture is no longer needed for the new design. */

        /* The central pulsing dot that invites the first interaction */
        #pulsing-dot {
            width: 1rem;
            height: 1rem;
            /* UPDATED: Darker color for contrast on light background */
            background-color: rgba(33, 37, 41, 0.5);
            border-radius: 9999px;
            animation: pulse 4s infinite ease-in-out;
            transition: background-color 0.3s;
            z-index: 10;
        }

        #pulsing-dot:hover {
            background-color: rgba(33, 37, 41, 0.9);
        }

        @keyframes pulse {
            0% { transform: scale(0.9); box-shadow: 0 0 0 0 rgba(33, 37, 41, 0.2); }
            70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(33, 37, 41, 0); }
            100% { transform: scale(0.9); box-shadow: 0 0 0 0 rgba(33, 37, 41, 0); }
        }
        
        /* The ripple effect that clears the screen */
        #ripple {
            position: absolute;
            border-radius: 50%;
            /* UPDATED: Darker ripple for contrast */
            border: 2px solid rgba(33, 37, 41, 0.5);
            transform: scale(0);
            opacity: 1;
            pointer-events: none; /* Allows clicks to pass through */
        }
        
        /* The container for the text and final icon */
        #content-center {
            position: absolute;
            text-align: center;
            /* UPDATED: Dark text color */
            color: #212529;
            opacity: 0;
            transition: opacity 2s ease-in;
            z-index: 20;
        }

        /* The SVG icon for the final invitation */
        #compass-stone {
            /* UPDATED: Increased size for the new icon */
            width: 64px; 
            height: 64px;
            margin: 1.5rem auto 0;
            cursor: pointer;
            opacity: 0;
            transition: opacity 3s ease-in, transform 0.3s ease;
        }
        
        #compass-stone:hover {
            transform: scale(1.1);
        }

        /* Utility class to hide elements visually but keep them accessible */
        .hidden-start {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div id="gate-container">
        <!-- The background-texture div is removed for a cleaner look -->

        <div id="pulsing-dot"></div>
        
        <div id="ripple"></div>

        <div id="content-center">
            <p id="poem-line" class="text-xl md:text-2xl font-light"></p>
            <div id="invitation-container" class="hidden-start">
                 <p id="invitation-line" class="text-xl md:text-2xl font-light"></p>
                 <!-- UPDATED: New SVG icon inspired by the user's illustration -->
                 <svg id="compass-stone" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
                            <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                            <feMerge>
                                <feMergeNode in="coloredBlur"/>
                                <feMergeNode in="SourceGraphic"/>
                            </feMerge>
                        </filter>
                    </defs>
                    <!-- Lantern Body -->
                    <path d="M35 80 V 30 C 35 25 40 20 45 20 H 55 C 60 20 65 25 65 30 V 80 H 35 Z" stroke="#212529" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <!-- Lantern Top -->
                    <path d="M30 20 H 70" stroke="#212529" stroke-width="2.5" stroke-linecap="round"/>
                    <path d="M45 15 C 45 10 55 10 55 15" stroke="#212529" stroke-width="2.5" stroke-linecap="round"/>
                    <!-- Lantern Handle -->
                    <path d="M40 20 C 25 5 75 5 60 20" stroke="#212529" stroke-width="2.5" stroke-linecap="round" fill="none"/>
                    <!-- Lantern Base -->
                     <path d="M30 80 H 70" stroke="#212529" stroke-width="2.5" stroke-linecap="round"/>
                    <!-- Flame/Light Source -->
                    <ellipse cx="50" cy="55" rx="8" ry="12" fill="#FDB813" filter="url(#glow)"/>
                </svg>
            </div>
        </div>
    </div>

    <script>
        // --- DOM Element References ---
        const gateContainer = document.getElementById('gate-container');
        const pulsingDot = document.getElementById('pulsing-dot');
        const ripple = document.getElementById('ripple');
        const contentCenter = document.getElementById('content-center');
        const poemLine = document.getElementById('poem-line');
        const invitationContainer = document.getElementById('invitation-container');
        const invitationLine = document.getElementById('invitation-line');
        const compassStone = document.getElementById('compass-stone');

        // --- Audio Synthesis Setup (Tone.js) ---
        let dissonantHum, noise, clearNote;
        
        // --- Main Experience Logic ---
        
        async function beginTransition() {
            if (Tone.context.state !== 'running') {
                await Tone.start();
            }
            
            dissonantHum = new Tone.FatOscillator({ type: "sawtooth", frequency: 80, detune: 40, volume: -28 }).toDestination();
            noise = new Tone.Noise({ type: "pink", volume: -38 }).toDestination();
            clearNote = new Tone.Synth({
                oscillator: { type: 'sine' },
                envelope: { attack: 2, decay: 1, sustain: 0.8, release: 3 },
                volume: -12
            }).toDestination();
            
            dissonantHum.start();
            noise.start();

            pulsingDot.style.display = 'none';
            animateRipple();
            
            dissonantHum.stop("+0.5");
            noise.stop("+0.5");
            
            // The background-texture div is gone, so no need to change its style.
            
            setTimeout(() => {
                clearNote.triggerAttackRelease("C4", "8n");
                contentCenter.style.opacity = '1';

                typewriterEffect(poemLine, 'My tangled mind, a knotted string, unravels here...', 100, () => {
                    beginInvitation();
                });
            }, 2000);
        }

        const checkToneInterval = setInterval(() => {
            if (typeof Tone !== 'undefined' && Tone) {
                clearInterval(checkToneInterval);
                pulsingDot.style.cursor = 'pointer';
                pulsingDot.addEventListener('click', beginTransition, { once: true });
            }
        }, 100);


        function beginInvitation() {
            poemLine.style.transition = 'opacity 2s ease-out';
            poemLine.style.opacity = '0';

            setTimeout(() => {
                poemLine.style.display = 'none';
                invitationContainer.style.display = 'block';
                
                typewriterEffect(invitationLine, 'Begin the journey home.', 100, () => {
                     compassStone.style.opacity = '1';
                });

                if (clearNote) {
                    clearNote.envelope.release = 4;
                    clearNote.triggerRelease();
                }

            }, 2500);
        }

        // --- Utility Functions ---

        function typewriterEffect(element, text, speed, onComplete) {
            let i = 0;
            element.innerHTML = "";
            function type() {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                } else if (onComplete) {
                    onComplete();
                }
            }
            type();
        }

        function animateRipple() {
            ripple.style.transition = 'transform 2.5s ease-out, opacity 2.5s ease-out';
            ripple.style.width = '1px';
            ripple.style.height = '1px';
            ripple.getBoundingClientRect(); 
            
            const size = Math.max(window.innerWidth, window.innerHeight) * 2;
            ripple.style.transform = `scale(${size})`;
            ripple.style.opacity = '0';
        }
        
        compassStone.addEventListener('click', () => {
            invitationLine.style.opacity = '0';
            compassStone.style.opacity = '0';
            setTimeout(() => {
                 typewriterEffect(invitationLine, 'And so the things I yearned to be, take root...', 100);
                 invitationLine.style.opacity = '1';
            }, 1000);
        });

    </script>
</body>
</html>
